/*! pinny 0.1.1 (https://github.com/mobify/pinny.git) */
(function(n){if("function"==typeof define&&define.amd)define(["$","bouncefix","plugin","shade"],n);else{var i=window.Zepto||window.jQuery;n(i,window.bouncefix,window.Plugin)}})(function(n,i,o){function t(n,i){t.__super__.call(this,n,i,t.DEFAULTS)}var e,s=n(document),p=n("html"),r=/chrome/i.test(navigator.userAgent);/android/i.test(navigator.userAgent),parseInt((/WebKit\/([0-9]+)/.exec(navigator.appVersion)||0)[1],10)||void 0,Function.prototype.bind||(Function.prototype.bind=function(n){var i=this;return function(){return i.apply(n)}});var a={OPENED:"pinny--is-open"},c={COMPONENT:'<{0} class="pinny__{0}">{1}</{0}>',HEADER:'<h1 class="pinny__title">{0}</h1><button class="pinny__close">Close</button>',FOOTER:"{0}"};return t.VERSION="0.1.1",t.DEFAULTS={effect:{open:n.noop,close:n.noop},header:"",footer:!1,zIndex:2,cssClass:"",coverage:"100%",easing:"swing",duration:200,shade:{},open:n.noop,opened:n.noop,close:n.noop,closed:n.noop},o.create("pinny",t,{animation:{beginClose:function(){s.on("touchmove",this._blockScroll)},openComplete:function(){r&&(p.css("position","fixed"),p.css("top",-1*e)),this._trigger("opened"),s.off("touchmove",this._blockScroll)},closeComplete:function(){r&&(p.css("position",""),p.css("top",""),window.scrollTo(0,e)),this._trigger("closed"),s.off("touchmove",this._blockScroll)}},_init:function(o){var t=this;this.iOSVersion=this._iOSVersion(),this.iOSVersion=this.iOSVersion&&this.iOSVersion[0]||!1,this.$element=n(o),this.$body=n(document.body),n(".pinny__body-wrapper").length||this.$body.wrapInner('<div class="pinny__body-wrapper">'),this.$bodyWrapper=this.$body.find(".pinny__body-wrapper"),this.$pinny=n("<section />").appendTo(this.$body).addClass("pinny").addClass(this.options.cssClass).css({position:"fixed",zIndex:this.options.zIndex,width:this.options.coverage,height:this.options.coverage}).on("click",".pinny__close",function(n){n.preventDefault(),t.close()}),this.options.header!==!1?this._build():this.$element.appendTo(this.$pinny),this.options.shade&&(this.$shade=this.$pinny.shade(n.extend(!0,{},{click:function(){t.close()}},n.extend(this.options.shade,{duration:this.options.duration})))),i.add("pinny__content"),this.effect=this.options.effect,this.$element.removeAttr("hidden"),this._bindEvents()},toggle:function(){this[this.$pinny.hasClass(a.OPENED)?"close":"open"]()},open:function(){this._trigger("open"),this.options.shade&&this.$shade.shade("open"),this.effect.open.call(this),this.$pinny.addClass(a.OPENED),this._enableScrollFix()},close:function(){this._trigger("close"),this.options.shade&&this.$shade.shade("close"),this.$pinny.removeClass(a.OPENED),this.effect.close.call(this),this._disableScrollFix()},_bindEvents:function(){this.$pinny.on("touchmove",function(i){n(i.target).parents().hasClass("pinny__content")||i.preventDefault()})},_build:function(){var i=n("<div />").addClass("pinny__wrapper").appendTo(this.$pinny);n(this._buildComponent("header")).prependTo(i),n("<div />").addClass("pinny__content").append(this.$element).appendTo(i),this.options.footer&&n(this._buildComponent("footer")).appendTo(i)},_buildComponent:function(i){var o=this.options[i];return o===!1?n([]):(o=this._isHtml(o)?o:c[i.toUpperCase()].replace("{0}",o),c.COMPONENT.replace(/\{0\}/g,i).replace(/\{1\}/g,o))},_isHtml:function(n){return/<[a-z][\s\S]*>/i.test(n)},_blockScroll:function(n){n.preventDefault()},_coverage:function(n){var i,o=this.options.coverage.match(/(\d*)%$/);return o&&(i=100-parseInt(o[1]),n&&(i/=n)),o?i+"%":this.options.coverage},_enableScrollFix:function(){if(e=document.body.scrollTop,r)p.css("position","fixed"),p.css("top",-1*e);else if(this.iOSVersion>=8){var n=parseInt(getComputedStyle(document.body).paddingTop),i=parseInt(getComputedStyle(document.body).paddingBottom),o=n+i;this.$body.css("margin-top",0).css("margin-bottom",0),this.$bodyWrapper.height(window.innerHeight).css("overflow","hidden").scrollTop(e-o)}else 7>=this.iOSVersion&&this.$pinny.find("input, select, textarea").bind("focus",function(){setTimeout(function(){window.scrollTo(0,e)},0)})},_disableScrollFix:function(){r?(p.css("position",""),p.css("top",""),window.scrollTo(0,e)):this.iOSVersion>=8?(this.$body.css("margin",""),this.$bodyWrapper.css("overflow","").css("height",""),window.scrollTo(0,e)):7>=this.iOSVersion&&this.$pinny.find("input, select, textarea").unbind("focus")},_iOSVersion:function(){if(/ip(hone|od|ad)/i.test(navigator.platform)){var n=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3]||0,10)]}}}),n("[data-pinny]").pinny(),n});