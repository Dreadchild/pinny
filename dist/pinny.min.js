/*! pinny 1.2.2 (https://github.com/mobify/pinny.git) */
!function(a){if("function"==typeof define&&define.amd)define(["$","plugin","bouncefix","velocity","hammer","lockup","shade","deckard"],a);else{var b=window.Zepto||window.jQuery;a(b,window.Plugin,window.bouncefix)}}(function(a,b,c,d,e){function f(a,b){f.__super__.call(this,a,b,f.DEFAULTS)}var g="Pinny requires a declared effect to operate. For more information read: https://github.com/mobify/pinny#initializing-the-plugin",h="a[href], area[href], input, select, textarea, button, iframe, object, embed, [tabindex], [contenteditable]",i="input, select, textarea";Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a)}});var j=a.os.ios&&a.os.major<=7,k=a.os.ios&&a.os.major>=8,l={PINNY:"pinny",HEADER:"pinny__header",WRAPPER:"pinny__wrapper",SPACER:"pinny__spacer",TITLE:"pinny__title",CLOSE:"pinny__close",CLOSING:"pinny__closing",CONTENT:"pinny__content",OPENED:"pinny--is-open",OPENING:"pinny--is-opening",SCROLLABLE:"pinny--is-scrollable"},m={COMPONENT:'<{0} class="'+l.PINNY+'__{0}">{1}</{0}>',HEADER:'<h1 class="'+l.TITLE+'">{0}</h1><button class="'+l.CLOSE+'">Close</button>',FOOTER:"{0}"},n={click:"click.pinny",focus:"focus.pinny",blur:"blur.pinny"};return f.VERSION="1.2.2",f.DEFAULTS={effect:null,container:null,appendTo:null,structure:{header:"",footer:!1},zIndex:2,cssClass:"",coverage:"100%",easing:"swing",duration:200,shade:{},open:a.noop,opened:a.noop,close:a.noop,closed:a.noop,scrollDuration:50,spacerHeight:300,swipeEnabled:!0,swipeOptions:{interactive:!0}},b.create("pinny",f,{animation:{openComplete:function(){this._disableExternalInputs(),this._focus(),!this._activePinnies()&&this.$pinny.lockup("lock"),this.$pinny.addClass(l.OPENED).attr("aria-hidden","false"),this.$container.attr("aria-hidden","true"),this._trigger("opened"),this.$pinny.removeClass(l.OPENING),k&&a(window).scrollTop(0)},closeComplete:function(){this.$pinny.removeClass(l.OPENED).attr("aria-hidden","true"),this._enableExternalInputs(),this._resetFocus(),!this._activePinnies()&&this.$pinny.lockup("unlock"),this.$container.attr("aria-hidden","false"),this._trigger("closed"),this.$pinny.removeClass(l.CLOSING)}},_init:function(b){if(this.id="pinny-"+a.uniqueId(),this.$element=a(b),this.$doc=a(document),this.$body=a("body"),this._build(),!this.options.effect)throw g;this.effect=this.options.effect.call(this),this.$element.removeAttr("hidden"),this._bindEvents()},destroy:function(){this.$pinny.lockup("destroy"),this.$pinny.shade("destroy"),this.$pinny.remove(),this.$element.appendTo(document.body).removeData(this.name)},toggle:function(){this[this.$pinny.hasClass(l.OPENED)?"close":"open"]()},open:function(b){if(!this._isOpen()||!this._isOpening()){if(!b){if(k){var d=a(window).scrollTop();window.scrollTo(0,+d+1)}this._trigger("open"),c.add(l.SCROLLABLE),this.options.shade&&this.$shade.shade("open")}this.effect.open.call(this,b)}},close:function(a){(this._isOpen()||this._isOpening())&&(a||(this._trigger("close"),c.remove(l.SCROLLABLE),this.options.shade&&this.$shade.shade("close")),this.effect.close.call(this,a))},_isOpening:function(){return this.$pinny.hasClass(l.OPENING)},_isOpen:function(){return this.$pinny.hasClass(l.OPENED)},_buildTouchManager:function(b,c){var d,f=c.openDirection,g=this,h=!1,i=g.options.swipeOptions.interactive,j=i?e.Pan:e.Swipe,k=new e.Manager(b,{recognizers:[[j,{direction:e.DIRECTION_HORIZONTAL,threshold:.2*g.$container.width()}]]}),m=!1;i?(k.on("panmove",function(b){var c=a(b.target),e=g._isOpen(),i=g._isOpening();if(d=b.direction,h=c.parents(".needstouch").length||c.hasClass(".needstouch").length||!e&&d!==f&&!i||e&&d===f,!h){var j=Math.abs(b.deltaX/g.$container.width()*100);if(g.$pinny.removeClass(l.CLOSING),g.$pinny.removeClass(l.OPENING),e)console.log("Close: ",j),g.$pinny.addClass(l.CLOSING),g.close(j);else{if(g._activePinnies())return;console.log("Open: ",j),g.$pinny.lockup("lock"),g.$pinny.addClass(l.OPENING),g.open(j)}}}),k.on("panend",function(){d===f?!g._activePinnies()&&!g._isOpen()&&g.open():(g.close(),g.$pinny.lockup("unlock"))})):k.on("swipe",function(b){var c=a(b.target);if(h=c.parents(".needstouch").length||c.hasClass(".needstouch").length,!h){var d=m?-1*b.deltaX:b.deltaX;d>=0?g.open():g.close()}})},_bindEvents:function(){if(this.$pinny.on("touchmove",function(b){a(b.target).parents().hasClass(l.CONTENT)||b.preventDefault()}),this.options.swipeEnabled){var b=this.effect;b.openDirection&&this._buildTouchManager(this.$container[0],b)}},_build:function(){var b=this;if(this.$pinny=a("<section />").addClass(l.PINNY).addClass(this.options.cssClass).css({position:"fixed",zIndex:this.options.zIndex,width:this.options.coverage,height:this.options.coverage}).on(n.click,"."+l.CLOSE,function(a){a.preventDefault(),b.close()}).lockup({container:this.options.container,locked:function(){b._handleKeyboardShown()},unlocked:function(){b._handleKeyboardHidden()}}),this.$container=this.$pinny.data("lockup").$container,this.$pinny.appendTo(this.options.appendTo?a(this.options.appendTo):this.$container),this.options.structure){var c=a("<div />").addClass(l.WRAPPER).appendTo(this.$pinny);this._buildComponent("header").appendTo(c),a("<div />").addClass(l.CONTENT).addClass(l.SCROLLABLE).append(this.$element).append(this.$spacer).appendTo(c),this._buildComponent("footer").appendTo(c)}else this.$element.appendTo(this.$pinny);this.$header=this.$pinny.find("."+l.HEADER),this.$content=this.$pinny.find("."+l.CONTENT),this.$spacer=a("<div />").addClass(l.SPACER).height(this.options.spacerHeight).attr("hidden","hidden").appendTo(this.$content),this._addAccessibility(),this.options.shade&&(this.$shade=this.$pinny.shade(a.extend(!0,{},{click:function(){b.close()}},a.extend(this.options.shade,{duration:this.options.duration}))))},_buildComponent:function(b){var c=this.options.structure[b],d=a([]);if(c!==!1){var e=this._isHtml(c)?c:m[b.toUpperCase()].replace("{0}",c);d=a(m.COMPONENT.replace(/\{0\}/g,b).replace(/\{1\}/g,e))}return d},_isHtml:function(a){return/<[a-z][\s\S]*>/i.test(a)},_activePinnies:function(){return!!a("."+l.OPENED+", ."+l.CLOSING).length},_coverage:function(a){var b,c=this.options.coverage.match(/(\d*)%$/);return c&&(b=100-parseInt(c[1]),a&&(b/=a)),c?b+"%":this.options.coverage},_addAccessibility:function(){var a=this.id+"__header",b=this.$pinny.find("h1, ."+l.TITLE).first(),c=this.$pinny.find("."+l.WRAPPER);this.$container.attr("aria-hidden","false"),this.$pinny.attr("role","dialog").attr("aria-labelledby",a).attr("aria-hidden","true").attr("tabindex","-1"),c.attr("role","document"),b.attr("id",a)},_focus:function(){this.originalActiveElement=document.activeElement,this.$pinny.children().first().focus()},_resetFocus:function(){this.originalActiveElement&&this.originalActiveElement.focus()},_disableExternalInputs:function(){if(!this.$pinny.lockup("isLocked")){var b=a(h).not(function(){return a(this).closest(".pinny").length});b.each(function(b,c){var d=a(c),e=d.attr("tabindex")||0;d.attr("data-orig-tabindex",e).attr("tabindex","-1")})}},_enableExternalInputs:function(){this._activePinnies()||a("[data-orig-tabindex]").each(function(b,c){var d=a(c),e=parseInt(d.attr("data-orig-tabindex"));e?d.attr("tabindex",e):d.removeAttr("tabindex"),d.removeAttr("data-orig-tabindex")})},_handleKeyboardShown:function(){j&&(this.$pinny.find(i).on(n.focus,function(){this._showSpacer(),this._scrollToTarget()}.bind(this)).on(n.blur,this._hideSpacer.bind(this)),this._showSpacer(),this._scrollToTarget())},_handleKeyboardHidden:function(){j&&this.$pinny.find(i).off(n.focus).off(n.blur)},_scrollToTarget:function(){d.animate(this._scrollTarget(),"scroll",{container:this.$content[0],offset:-1*(this.$header.height()+parseInt(this.$content.css("padding-top"))),duration:this.options.scrollDuration})},_showSpacer:function(){this.$spacer.removeAttr("hidden")},_hideSpacer:function(){!this._activeElement().is(i)&&this.$spacer.attr("hidden","")},_activeElement:function(){return a(document.activeElement)},_scrollTarget:function(){for(var a=this._activeElement(),b=a.parent();"relative"===b.css("position")&&!b.hasClass(l.CONTENT);)a=b,b=a.parent();return a}}),a("[data-pinny]").each(function(){var b=a(this),c=a(this).data("pinny");if(!c.length)throw g;b.pinny({effect:c})}),a});