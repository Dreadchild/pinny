/*! pinny 0.1.1 (https://github.com/mobify/pinny.git) */
(function(i){if("function"==typeof define&&define.amd)define(["$","bouncefix","plugin","shade"],i);else{var t=window.Zepto||window.jQuery;i(t,window.bouncefix,window.Plugin)}})(function(i,t,n){function e(i,t){e.__super__.call(this,i,t,e.DEFAULTS)}var o,s=i(document),r=i("html"),a=/chrome/i.test(navigator.userAgent),p="Pinny requires a declared effect to operate. For more information read: https://github.com/mobify/pinny#initializing-the-plugin";Function.prototype.bind||(Function.prototype.bind=function(i){var t=this;return function(){return t.apply(i)}});var c={PINNY:"pinny",BODYWRAPPER:"pinny__body-wrapper",WRAPPER:"pinny__wrapper",TITLE:"pinny__title",CLOSE:"pinny__close",CONTENT:"pinny__content",OPENED:"pinny--is-open"},h={COMPONENT:'<{0} class="'+c.PINNY+'__{0}">{1}</{0}>',HEADER:'<h1 class="'+c.TITLE+'">{0}</h1><button class="'+c.CLOSE+'">Close</button>',FOOTER:"{0}"};return e.VERSION="0.1.1",e.DEFAULTS={effect:{open:function(){throw p},close:function(){throw p}},structure:{header:"",footer:!1},zIndex:2,cssClass:"",coverage:"100%",easing:"swing",duration:200,shade:{},open:i.noop,opened:i.noop,close:i.noop,closed:i.noop},n.create("pinny",e,{animation:{beginClose:function(){s.on("touchmove",this._blockScroll)},openComplete:function(){this._trigger("opened"),s.off("touchmove",this._blockScroll)},closeComplete:function(){this._trigger("closed"),s.off("touchmove",this._blockScroll)}},_init:function(n){var e=this;this.iOSVersion=this._iOSVersion(),this.iOSVersion=this.iOSVersion&&this.iOSVersion[0]||!1,this.$element=i(n),this.$body=i("body"),i("."+c.BODYWRAPPER).length?this.$bodyWrapper=this.$body.find("."+c.BODYWRAPPER):(this.$bodyWrapper=i("<div>").addClass(c.BODYWRAPPER),this.$body.wrapInner(this.$bodyWrapper)),this.$pinny=i("<section />").appendTo(this.$body).addClass(c.PINNY).addClass(this.options.cssClass).css({position:"fixed",zIndex:this.options.zIndex,width:this.options.coverage,height:this.options.coverage}).on("click","."+c.CLOSE,function(i){i.preventDefault(),e.close()}),this._build(),t.add(c.CONTENT),this.effect=this.options.effect,this.$element.removeAttr("hidden"),this._bindEvents()},toggle:function(){this[this.$pinny.hasClass(c.OPENED)?"close":"open"]()},open:function(){this._trigger("open"),this.effect.open.call(this),this.options.shade&&this.$shade.shade("open"),this.$pinny.addClass(c.OPENED),this._enableScrollFix()},close:function(){this._trigger("close"),this.$pinny.removeClass(c.OPENED),this.options.shade&&this.$shade.shade("close"),this.effect.close.call(this),this._disableScrollFix()},_bindEvents:function(){this.$pinny.on("touchmove",function(t){i(t.target).parents().hasClass(c.CONTENT)||t.preventDefault()})},_build:function(){var t=this;if(this.options.structure){var n=i("<div />").addClass(c.WRAPPER).appendTo(this.$pinny);this._buildComponent("header").appendTo(n),i("<div />").addClass(c.CONTENT).append(this.$element).appendTo(n),this._buildComponent("footer").appendTo(n)}else this.$element.appendTo(this.$pinny);this.options.shade&&(this.$shade=this.$pinny.shade(i.extend(!0,{},{click:function(){t.close()}},i.extend(this.options.shade,{duration:this.options.duration}))))},_buildComponent:function(t){var n=this.options.structure[t],e=i([]);if(n!==!1){var o=this._isHtml(n)?n:h[t.toUpperCase()].replace("{0}",n);e=i(h.COMPONENT.replace(/\{0\}/g,t).replace(/\{1\}/g,o))}return e},_isHtml:function(i){return/<[a-z][\s\S]*>/i.test(i)},_blockScroll:function(i){i.preventDefault()},_coverage:function(i){var t,n=this.options.coverage.match(/(\d*)%$/);return n&&(t=100-parseInt(n[1]),i&&(t/=i)),n?t+"%":this.options.coverage},_enableScrollFix:function(){if(o=document.body.scrollTop,a)r.css("position","fixed"),r.css("top",-1*o);else if(this.iOSVersion>=8){var i=parseInt(getComputedStyle(document.body).paddingTop),t=parseInt(getComputedStyle(document.body).paddingBottom),n=i+t;this.$body.css("margin-top",0).css("margin-bottom",0),this.$bodyWrapper.height(window.innerHeight).css("overflow","hidden").scrollTop(o-n)}else 7>=this.iOSVersion&&this.$pinny.find("input, select, textarea").bind("focus",function(){setTimeout(function(){window.scrollTo(0,o)},0)})},_disableScrollFix:function(){a?(r.css("position",""),r.css("top",""),window.scrollTo(0,o)):this.iOSVersion>=8?(this.$body.css("margin",""),this.$bodyWrapper.css("overflow","").css("height",""),window.scrollTo(0,o)):7>=this.iOSVersion&&this.$pinny.find("input, select, textarea").unbind("focus")},_iOSVersion:function(){if(/ip(hone|od|ad)/i.test(navigator.platform)){var i=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3]||0,10)]}}}),i("[data-pinny]").each(function(){var t=i(this),n=i(this).data("pinny");if(!n.length)throw p;t.pinny({effect:n})}),i});