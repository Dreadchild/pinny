/*! pinny 0.1.1 (https://github.com/mobify/pinny.git) */
(function(n){if("function"==typeof define&&define.amd)define(["$","bouncefix","plugin","shade"],n);else{var t=window.Zepto||window.jQuery;n(t,window.bouncefix,window.Plugin)}})(function(n,t,i){function e(n,t){e.__super__.call(this,n,t,e.DEFAULTS)}var o,s,a=n(document),c=n("html"),r=/chrome/i.test(navigator.userAgent);Function.prototype.bind||(Function.prototype.bind=function(n){var t=this;return function(){return t.apply(n)}});var p={OPENED:"pinny--is-open"},h={COMPONENT:'<{0} class="pinny__{0}">{1}</{0}>',HEADER:'<h1 class="pinny__title">{0}</h1><button class="pinny__close" role="button">Close</button>',FOOTER:"{0}"};return e.VERSION="0.1.1",e.DEFAULTS={effect:{open:n.noop,close:n.noop},header:"",footer:!1,zIndex:2,cssClass:"",coverage:"100%",easing:"swing",duration:200,shade:{},open:n.noop,opened:n.noop,close:n.noop,closed:n.noop},i.create("pinny",e,{animation:{beginClose:function(){a.on("touchmove",this._blockScroll)},openComplete:function(){r&&(o=document.body.scrollTop,c.css("position","fixed"),c.css("top",-1*o)),this._trigger("opened"),a.off("touchmove",this._blockScroll),this._focusPinny()},closeComplete:function(){r&&(c.css("position",""),c.css("top",""),window.scrollTo(0,o)),this._trigger("closed"),a.off("touchmove",this._blockScroll),this._unfocusPinny()}},_init:function(i){var e=this;this.id="pinny-"+this._uuid(),this.$element=n(i),this.$body=n(document.body),this.$pinny=n("<section />").appendTo(this.$body).addClass("pinny").addClass(this.options.cssClass).css({position:"fixed",zIndex:this.options.zIndex,width:this.options.coverage,height:this.options.coverage}).on("click",".pinny__close",function(n){n.preventDefault(),e.close()}),this.options.header!==!1?this._build():this.$element.appendTo(this.$pinny),this.options.shade&&(this.$shade=this.$pinny.shade(n.extend(!0,{},{click:function(){e.close()}},n.extend(this.options.shade,{duration:this.options.duration})))),t.add("pinny__content"),this.effect=this.options.effect,this.$element.removeAttr("hidden"),this._bindEvents()},toggle:function(){this[this.$pinny.hasClass(p.OPENED)?"close":"open"]()},open:function(){this._trigger("open"),this.options.shade&&this.$shade.shade("open"),this.effect.open.call(this),this.$pinny.addClass(p.OPENED)},close:function(){this._trigger("close"),this.options.shade&&this.$shade.shade("close"),this.$pinny.removeClass(p.OPENED),this.effect.close.call(this)},_bindEvents:function(){this.$pinny.on("touchmove",function(t){n(t.target).parents().hasClass("pinny__content")||t.preventDefault()})},_build:function(){var t=n("<div />").addClass("pinny__wrapper").appendTo(this.$pinny);n(this._buildComponent("header")).prependTo(t),n("<div />").addClass("pinny__content").append(this.$element).appendTo(t),this.options.footer&&n(this._buildComponent("footer")).appendTo(t),this._initA11y()},_buildComponent:function(t){var i=this.options[t];return i===!1?n([]):(i=this._isHtml(i)?i:h[t.toUpperCase()].replace("{0}",i),h.COMPONENT.replace(/\{0\}/g,t).replace(/\{1\}/g,i))},_isHtml:function(n){return/<[a-z][\s\S]*>/i.test(n)},_blockScroll:function(n){n.preventDefault()},_coverage:function(n){var t,i=this.options.coverage.match(/(\d*)%$/);return i&&(t=100-parseInt(i[1]),n&&(t/=n)),i?t+"%":this.options.coverage},_initA11y:function(){var n=this.id+"__header",t=this.$pinny.find(".pinny__header h1").first(),i=this.$pinny.find(".pinny__wrapper");this.$pinny.attr("role","dialog").attr("aria-labelledby",n).attr("aria-hidden","true").attr("tabindex","-1"),i.attr("role","document"),t.attr("id",n)},_focusPinny:function(){s=document.activeElement,this.$pinny.attr("aria-hidden","false"),this.$pinny.focus();var t=this;this.$pinny.keydown(function(i){t._trapTabs(n(this),i)})},_unfocusPinny:function(){this.$pinny.attr("aria-hidden","true"),s.focus()},_trapTabs:function(n,t){var i="a[href], area[href], input, select, textarea, button, iframe, object, embed, [tabindex], [contenteditable]";if(9===t.which){var e,o=n.find("*");e=o.filter(i).filter(":visible");var s;s=document.activeElement;var a;a=e.length;var c;c=e.index(s),t.shiftKey?0===c&&(e.get(a-1).focus(),t.preventDefault()):c===a-1&&(e.get(0).focus(),t.preventDefault())}},_uuid:function(){var n=0;return function(){return n+=1}}()}),n("[data-pinny]").pinny(),n});